"""
File contains functions used to train Linear Discriminant Analysis.

Author: Dominik Macko
"""

from typing import Tuple

import numpy as np
import pandas as pd
from sklearn.discriminant_analysis import LinearDiscriminantAnalysis

from .utils import get_inverse_class_priors

def train_lda(train_X: np.array,
              train_y: np.array,
              use_inverse_priors: bool=True
              ) -> Tuple[LinearDiscriminantAnalysis, pd.DataFrame]:
    """Trains L.
    
    train_X - training set features
    train_y - training set targets
    use_inverse_priors - specifies whether to use inverse class priors
    
    returns model
    """
    
    if use_inverse_priors:
        model = LinearDiscriminantAnalysis(solver="svd", priors=get_inverse_class_priors(pd.Series(train_y.ravel())))
    else:
        model = LinearDiscriminantAnalysis(solver="svd")
    model.fit(train_X, train_y.ravel())
    return model
    